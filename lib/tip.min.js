window.addEventListener("load",place);function place(){var a=document.querySelectorAll("img[data-src]");if(/bot|googlebot|crawler|spider|robot|crawling/i.test(navigator.userAgent)){for(var b=0;b<a.length;b++)a[b].src=a[b].dataset.src;return}for(var c=function(){var c=a[b];c.style.transition="opacity 1s";var e=c.width,f=c.height;d=new XMLHttpRequest;var g=c.dataset.src.replace(/\.[^/.]+$/,".tri");d.open("GET",g,!0),d.responseType="arraybuffer",d.onreadystatechange=function(a){var b=a.currentTarget.response;if(b){var l=document.createElement("div");l.style.display="inline-block",l.style.position="relative",l.style.overflow="hidden",l.style.padding="0",l.style.margin="0";var d=c.cloneNode();c.style.position="absolute",d.style.verticalAlign="middle",c.parentNode.replaceChild(l,c),(c.style.width||e)&&(l.style.width=c.style.width||e+"px",d.style.width="100%",d.style.setProperty("height","calc(100% - 4px)"),c.style.width="100%"),(c.style.height||f)&&(l.style.height=c.style.height||f+"px",d.style.height="100%",c.style.height="100%"),l.appendChild(c),l.appendChild(d);var g=new DataView(b),h=parseData(g),i=g.getUint16(0,!0),j=g.getUint16(2,!0),k=document.createElement("canvas",{alpha:!1});k.width=i,k.height=j,d.style.transition="",d.style.opacity=0,d.src=k.toDataURL("image/jpeg"),renderData(k,h),c.src=k.toDataURL("image/jpeg");var m=c.dataset.blur;m&&(c.style.filter="blur(".concat(m,"px)")),c.onload=function(){d.src=c.dataset.src,d.onload=function(){d.style.opacity=1,c.style.opacity=0,d.addEventListener("transitionend",function(){c.style.visibility="hidden"})}}}},d.send()},b=0;b<a.length;b++){var d;c()}}function renderData(a,b){var c=a.getContext("2d");c.clearRect(0,0,a.width,a.height);for(var d=0;d<b.length;d++){var e=b[d].triangle,f=b[d].color,g="rgb(".concat(f[0],", ").concat(f[1],", ").concat(f[2],")");c.fillStyle=g,c.strokeStyle=g,c.lineWidth=1,c.beginPath(),c.moveTo(e[0][0],e[0][1]),c.lineTo(e[1][0],e[1][1]),c.lineTo(e[2][0],e[2][1]),c.closePath(),c.fill(),c.stroke()}}function parseData(a){for(var b=[{triangle:[[a.getUint16(5,!0),a.getUint16(7,!0)],[a.getUint16(9,!0),a.getUint16(11,!0)],[a.getUint16(13,!0),a.getUint16(15,!0)]],color:[a.getUint8(17,!0),a.getUint8(18,!0),a.getUint8(19,!0)],remaining:a.getUint8(4,!0)}],c=0,d=20;d<a.byteLength;){var e=b[c],f=a.getUint8(d,!0);d++;var g,h=3&f>>2,j=b[c].triangle;1&f>>4?(g=[e.triangle[h][0]+a.getInt8(d,!0),e.triangle[h][1]+a.getInt8(d+1,!0)],d+=2):(g=[a.getUint16(d,!0),a.getUint16(d+2,!0)],d+=4);var k;if(1&f>>5){var l=a.getUint16(d,!0);k=[e.color[0]+(63&l)-32,e.color[1]+(63&l>>6)-32,e.color[2]+(15&l>>12|(3&f>>6)<<4)-32],d+=2}else k=[a.getUint8(d,!0),a.getUint8(d+1,!0),a.getUint8(d+2,!0)],d+=3;var m=[j[h],j[(h+1)%3],g].sort(function(c,a){return c[1]==a[1]?c[0]-a[0]:c[1]-a[1]});for(b.push({triangle:m,color:k,remaining:3&f}),b[c].remaining--;b[c]&&0==b[c].remaining;)c++}return b}