window.addEventListener("load",place);function place(){var a=document.querySelectorAll("img[data-src]");if(/bot|googlebot|crawler|spider|robot|crawling/i.test(navigator.userAgent)){for(var b=0;b<a.length;b++)a[b].src=a[b].dataset.src;return}for(var c=function(){var c=a[b],f=window.getComputedStyle(c).objectFit,g=window.getComputedStyle(c).objectPosition;d="contain";f&&g&&("cover"===f?d="cover":"fill"===f?d="100% 100%":"none"===f?d="auto":void 0,c.style.backgroundPosition=g);c.style.backgroundSize=d,c.style.opacity="0",c.style.backgroundRepeat="no-repeat",c.style.cssText+="transition: background 1s, background-position 0s, background-size 0s !important;",e=new XMLHttpRequest;var h=c.dataset.src.replace(/\.[^/.]+$/,".tri");e.open("GET",h,!0),e.responseType="arraybuffer",e.onreadystatechange=function(a){var b=a.currentTarget.response;if(b){var d=new DataView(b),e=parseData(d),f=d.getUint16(0,!0),g=d.getUint16(2,!0),h=document.createElement("canvas",{alpha:!1});h.width=f,h.height=g;var i=h.toDataURL();c.src=i,renderData(h,e),c.style.backgroundImage="url('".concat(h.toDataURL("image/jpeg"),"')"),c.style.opacity="1";var j=new Image;j.src=c.dataset.src,j.onload=function(){var a=document.createElement("canvas"),b=a.getContext("2d");a.width=j.naturalWidth,a.height=j.naturalHeight,b.drawImage(j,0,0),c.style.backgroundImage="url(".concat(a.toDataURL("image/jpeg"),")"),c.ontransitionend=function(){for(var a,b=c.attributes,d=0;d<b.length;d++)a=b[d],"src"!=a.nodeName&&j.setAttribute(a.nodeName,a.nodeValue);j.style.background="",j.style.opacity="",j.style.transition="",c.parentNode.replaceChild(j,c)}}}},e.send()},b=0;b<a.length;b++){var d,e;c()}}function renderData(a,b){var c=a.getContext("2d");c.clearRect(0,0,a.width,a.height);for(var d=0;d<b.length;d++){var e=b[d].triangle,f=b[d].color,g="rgb(".concat(f[0],", ").concat(f[1],", ").concat(f[2],")");c.fillStyle=g,c.strokeStyle=g,c.lineWidth=1,c.beginPath(),c.moveTo(e[0][0],e[0][1]),c.lineTo(e[1][0],e[1][1]),c.lineTo(e[2][0],e[2][1]),c.closePath(),c.fill(),c.stroke()}}function parseData(a){for(var b=[{triangle:[[a.getUint16(5,!0),a.getUint16(7,!0)],[a.getUint16(9,!0),a.getUint16(11,!0)],[a.getUint16(13,!0),a.getUint16(15,!0)]],color:[a.getUint8(17,!0),a.getUint8(18,!0),a.getUint8(19,!0)],remaining:a.getUint8(4,!0)}],c=0,d=20;d<a.byteLength;){var e=b[c],f=a.getUint8(d,!0);d++;var g,h=3&f>>2,j=b[c].triangle;1&f>>4?(g=[e.triangle[h][0]+a.getInt8(d,!0),e.triangle[h][1]+a.getInt8(d+1,!0)],d+=2):(g=[a.getUint16(d,!0),a.getUint16(d+2,!0)],d+=4);var k;if(1&f>>5){var l=a.getUint16(d,!0);k=[e.color[0]+(63&l)-32,e.color[1]+(63&l>>6)-32,e.color[2]+(15&l>>12|(3&f>>6)<<4)-32],d+=2}else k=[a.getUint8(d,!0),a.getUint8(d+1,!0),a.getUint8(d+2,!0)],d+=3;var m=[j[h],j[(h+1)%3],g].sort(function(c,a){return c[1]==a[1]?c[0]-a[0]:c[1]-a[1]});for(b.push({triangle:m,color:k,remaining:3&f}),b[c].remaining--;b[c]&&0==b[c].remaining;)c++}return b}